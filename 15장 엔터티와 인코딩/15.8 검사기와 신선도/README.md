# 15.8 검사기와 신선도

클라이언트가 서버로부터 자원을 받았을 때, 얼마나 오랫동안 캐시로 저장할 수 있을까요?
요
자원이 '만료'되면 새로운 복사본을 요청해야 합니다.
다
서버에서 문서가 변경되지 않았다면 캐시를 계속 사용할 수 있습니다.

클라이언트는 서버에 현재 가지고 있는 버전을 알려주는 validator를 사용해서 복사본을 보내달라고 요청합니다.

## Freshness

얼마나 오랫동안 캐시로 저장할 수 있는지에 대한 내용입니다.

- Expires
- Cache-Control

둘 중 하나를 사용할 수 있습니다.

Expires는 정확한 날짜와 시간을 지정합니다.

Cache-Control은 문서의 최대 수명을 초 단위로 지정합니다. 시계 동기화에 의존하지 않기 때문에 더 정확합니다.

캐시 컨트롤은 서버와 클라이언트 양쪽에서 사용될 수 있으며, 다양한 방법으로 신선도를 지정할 수 있습니다.

- no-cache: 캐시된 응답을 사용하기 전에 반드시 원본 서버에 재검증을 요청합니다.
- no-store: 어떠한 응답도 캐시되어서는 안됩니다. 민감한 정보를 다룰 때 사용됩니다.
- max-age: 얼마나 오랫동안 신선하게 간주될지를 초 단위로 지정. 새로운 요청 없이 캐시된 응답을 사용할 수 있습니다.
- must-revalidate: 캐시된 응답이 만료된 뒤에는 반드시 서버의 재검증이 이루어져야 한다는 것을 명시합니다.
- public or private: 응답이 공용 캐시에 저장될 수 있는지 나타냅니다.

등등이 있습니다.

## Conditionals and Validators

더 이상 신선하지 않다면?

조건부 요청을 통해 리소스가 변경되었을 때만 새로 가져옵니다.

조건부 요청은 if 로 시작하는 조건부 헤더를 통해 구현됩니다.

서버는 조건이 참이 아닐 경우 HTTP 오류 코드를 보냅니다.

- If-Modified-Since: 문서의 마지막 수정 날짜를 검증자로 사용합니다.
- If-None-Match: 문서의 ETag 값을 검증자로 사용합니다.

Last-Modified, Etag 등등이 주요한 검증자로 사용됩니다.

### 약한 검증자와 강한 검증자

웹 페이지의 크기 같은 것이 여기에 해당됩니다. 페이지의 내용이 조금 바뀌었어도 크기는 똑같을 수 있으니까, 페이지가 바뀌었다는 단서를 쉽게 얻을 수는 있지만 페이지가 바뀌었다는 것을 100퍼센트 알기는 어렵습니다.

반면 체크섬 같은 경우는 확실하게 파일이 변조되었는지를 파악할 수 있습니다.

ETag가 강한 검증자의 일종인데, 서버는 파일이 바뀔 때마다 ETag에 다른 값을 넣어서, 파일이 새로운지 아닌지를 구별할 수 있게 합니다.

클라이언트와 서버는 때때로 느슨한 버전의 검증을 채택할 수도 있습니다. 예를 들어 서버는 인기 있는 문서에 대한 변경을 허용하고자 할때 대량의 트래픽을 유발하려고 하지 않을 수도 있습니다. 이런 경우에 서버는 W/ 태그를 통해 약한 태그를 이용할 수 있습니다.
